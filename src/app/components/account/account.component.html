<div class="flex-column">
  <span class="flex-row transaction-header-row">
    <h2>{{ account.name }}</h2>
    <button pButton type="button" icon="pi pi-plus" class="add-transaction-button" (click)="addTransactionDialog.show()"></button>
  </span>
  <p-table [value]="transactions" styleClass="p-datatable-sm" editMode="row" dataKey="id">
    <ng-template pTemplate="colgroup">
        <colgroup>
            <col style="width:15%">
            <col style="width:25%">
            <col style="width:25%">
            <col style="width:25%">
            <col style="width:10%">
        </colgroup>
    </ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th>Date</th>
        <th>Recipient</th>
        <th>Category</th>
        <th>Cost</th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-transaction let-editing="editing">
      <tr [pEditableRow]="transaction">
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <p-calendar inputId="basic" [(ngModel)]="transaction.date"></p-calendar>
            </ng-template>
            <ng-template pTemplate="output">
              {{ transaction.date | date:'shortDate' }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input pInputText type="text" [(ngModel)]="transaction.recipient">
            </ng-template>
            <ng-template pTemplate="output">
              {{ transaction.recipient }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <p-dropdown [options]="categories" [(ngModel)]="transaction.categoryId" optionLabel="name" optionValue="id"></p-dropdown>
            </ng-template>
            <ng-template pTemplate="output">
              {{ getCategoryName(transaction.categoryId) }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <p-inputNumber [(ngModel)]="transaction.cost" mode="currency" currency="USD" locale="en-US"></p-inputNumber>
            </ng-template>
            <ng-template pTemplate="output">
              {{ transaction.cost | currency: 'USD' }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td style="text-align:center">
            <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil" class="p-button-rounded p-button-text" style="margin-right: .5em"></button>
            <button *ngIf="!editing" pButton type="button" icon="pi pi-trash" class="p-button-rounded p-button-danger p-button-text" (click)="delete(transaction)"></button>
            <button *ngIf="editing" pButton type="button" pSaveEditableRow icon="pi pi-check" class="p-button-rounded p-button-success p-button-text" style="margin-right: .5em" (click)="save(transaction)"></button>
            <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="p-button-rounded p-button-warning p-button-text"></button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<app-add-transaction-dialog #addTransactionDialog></app-add-transaction-dialog>